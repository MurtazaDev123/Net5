
@{
    ViewBag.Title = "Dashboard";
}

@section HeadSection {

}

<div class="content-wrapper" id="divLoading" style="position: fixed;width: 100%;height: 100%;top: 0;left: 0;z-index: 9999;padding-top: 200px;">

    <div class="bar-loader">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>
</div>

<div class="content-wrapper" id="divContent">
    <div class="row">
        <div class="col-md-3 grid-margin">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title mb-0">Total Uploaded Video</h4>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-inline-block pt-3">
                            <div class="d-md-flex">
                                <h2 class="mb-0 total_videos">0</h2>
                            </div>
                            <small class="text-gray"></small>
                        </div>
                        <div class="d-inline-block">
                            <i class="fas fa-chart-pie text-info icon-lg"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3 grid-margin">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title mb-0">Total Pending Video</h4>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-inline-block pt-3">
                            <div class="d-md-flex">
                                <h2 class="mb-0 total_pending_videos">0</h2>
                            </div>
                            <small class="text-gray"></small>
                        </div>
                        <div class="d-inline-block">
                            <i class="fas fa-cubes text-warning icon-lg"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3 grid-margin">
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title mb-0">Total @(BusinessLogic.clsSession.LoginType == 1 ? "Subscription" : "Subscribers")</h4>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-inline-block pt-3">
                            <div class="d-md-flex">
                                <h2 class="mb-0 total_subscription">0</h2>
                            </div>
                            <small class="text-gray"></small>
                        </div>
                        <div class="d-inline-block">
                            <i class="fas fa-suitcase text-success icon-lg"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        @if (BusinessLogic.clsSession.LoginType == 1)
        {
            <div class="col-md-3 grid-margin">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-0">Total Customer</h4>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-inline-block pt-3">
                                <div class="d-md-flex">
                                    <h2 class="mb-0 total_customers">0</h2>
                                </div>
                                <small class="text-gray"></small>
                            </div>
                            <div class="d-inline-block">
                                <i class="fas fa-signal text-danger icon-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div class="col-md-3 grid-margin">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title mb-0">Monetization <span class="badge badge-danger" id="span_monetization" style="margin-left: 87px; padding: 5px 10px 5px 10px;">OFF</span> </h4> 
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-inline-block pt-3">
                                <div class="d-md-flex">
                                    <h2 class="mb-0 total_monetization">0/0</h2>
                                </div>
                                <small class="text-gray"></small>
                            </div>
                            <div class="d-inline-block">
                                <i class="fas fa-desktop text-danger icon-lg"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>

    <div class="row" style="display: @(BusinessLogic.clsSession.LoginType == 1 ? "block;": "none;")">
        <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-9">
                            <h4 class="card-title">
                                <i class="fas fa-gift"></i>
                                Daily Uploaded Video
                            </h4>
                        </div>
                        <div class="col-sm-3">
                            <div class="form-group row">
                                <label class="col-sm-4 col-form-label text-right">Month: </label>
                                <div class="col-sm-8">
                                    <div id="a11" class="input-group date datepicker datepicker-month-selection" style="padding-left:0px;">
                                        <input type="text" class="form-control" id="dtpMonth" name="dtpMonth" autocomplete="off">
                                        <span class="input-group-addon input-group-append border-left">
                                            <span class="far fa-calendar input-group-text" style="padding:7px;"></span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <canvas id="sales-chart" height="100"></canvas>
                    <div id="orders-chart-legend" class="orders-chart-legend"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="row" style="display: @(BusinessLogic.clsSession.LoginType == 2 ? "block;": "none;")">
        <div class="col-12">
            <div class="row portfolio-grid" id="top_video_list">
                @*<div class="col-xl-3 col-lg-3 col-md-3 col-sm-6 col-12">
                    <figure class="effect-text-in">
                        <img src="https://www.netfive.tv/content/uploads/videos/thumb/Manqabat637203113297940265.jpg" alt="image" />
                        <figcaption>
                            <h4 style="font-size: 12px; color: black; font-weight: normal;"><span style="float: left;">2.5 Views </span><span style="float: right;"><i class="fa fa-thumbs-up"></i>2.1k&nbsp;&nbsp;&nbsp;<i class="fa fa-thumbs-down"></i>1.1k</span></h4>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit</p>
                        </figcaption>
                    </figure>
                </div>*@
            </div>
        </div>
    </div>
</div>

@section FooterSection {

    <script>

        var current_date = moment();

        $(document).ready(function () {

            $.ajax({
                type: "POST",
                url: "/Admin/DashboardData",
                data: { },
                success: function (result) {

                    console.log(result);

                    if (result.success == true) {

                        $(".total_videos").text(result.data.total_videos);
                        $(".total_pending_videos").text(result.data.total_pending_videos);
                        $(".total_customers").text(result.data.total_customers);
                        $(".total_subscription").text(result.data.total_subscribers);
                        $(".total_monetization").text(result.data.total_active_montz + "/" + result.data.total_montz);

                        if (result.data.total_active_montz == result.data.total_montz) {
                            $('#span_monetization').removeClass('badge-danger');
                            $('#span_monetization').addClass('badge-success');
                            $('#span_monetization').text('ON');
                        }


                        if (result.data.videos != null) {
                            var _html = "";
                            $.each(result.data.videos, function (i, v) {
                                _html += "  <div class='col-xl-3 col-lg-3 col-md-3 col-sm-6 col-12'>" +
                                    "           <figure class='effect-text-in'>" +
                                    "               <img src='/" + v["Image"] + "' alt='image' />" +
                                    "               <figcaption>" +
                                    "                   <h4 style='font-size: 12px; font-weight: normal;'><span style='float: left;'>" + v["Views"] + " Views </span><span style='float: right;'><i class='fa fa-thumbs-up'></i> "+ v["Likes"] +"&nbsp;&nbsp;&nbsp;<i class='fa fa-thumbs-down'></i> "+ v["DisLikes"] +"</span></h4>" +
                                    "                   <p>" + v["Title"] + "</p>" +
                                    "               </figcaption>" +
                                    "           </figure>" +
                                    "       </div>";
                            });
                        }


                        $("#top_video_list").html(_html);
                    }

                },
                failure: function (data) {
                    alert(data);
                },
                complete: function () {
                    $("#divLoading").fadeOut();
                }
            });

        });


        $("#dtpMonth").val(current_date.format("MMM YYYY"));

        $('.datepicker-month-selection').datepicker({
            enableOnReadonly: true,
            todayHighlight: true,
            autoclose: true,
            format: 'M yyyy'
        });


        if ($('#sales-chart').length) {
            var lineChartCanvas = $("#sales-chart").get(0).getContext("2d");
            var data = {
                labels: ["2013", "2014", "2014", "2015", "2016", "2017", "2018"],
                datasets: [
                  {
                      label: 'Support',
                      data: [0, 0, 0, 0, 0, 0, 0],
                      borderColor: [
                        '#392c70'
                      ],
                      borderWidth: 3,
                      fill: false
                  },
                  {
                      label: 'Product',
                      data: [0, 0, 0, 0, 0, 0, 0],
                      borderColor: [
                        '#d1cede'
                      ],
                      borderWidth: 3,
                      fill: false
                  }
                ]
            };
            var options = {
                scales: {
                    yAxes: [{
                        gridLines: {
                            drawBorder: false
                        },
                        ticks: {
                            stepSize: 2000,
                            fontColor: "#686868"
                        }
                    }],
                    xAxes: [{
                        stacked: true,
                        display: false,
                        gridLines: {
                            drawBorder: false
                        }
                    }]
                },
                legend: {
                    display: false
                },
                elements: {
                    point: {
                        radius: 3
                    }
                },
                stepsize: 1
            };
            var lineChart = new Chart(lineChartCanvas, {
                type: 'line',
                data: data,
                options: options
            });
        }

    </script>
}